{"ID":"20241024131044-0gca2a0","Spec":"1","Type":"NodeDocument","Properties":{"custom-sy-readonly":"true","id":"20241024131044-0gca2a0","title":"Docker部署-Nginx","type":"doc","updated":"20241030135752"},"Children":[{"ID":"20241024131045-kx9xozg","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241024131045-kx9xozg","updated":"20241024131045"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"部署前端"}]},{"ID":"20241024131046-8wgxqyk","Type":"NodeBlockquote","Properties":{"id":"20241024131046-8wgxqyk","updated":"20241024131046"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20241024131047-4532t6q","Type":"NodeParagraph","Properties":{"id":"20241024131047-4532t6q","updated":"20241024131047"},"Children":[{"Type":"NodeText","Data":"参考："}]},{"ID":"20241024131048-4e6exg6","Type":"NodeParagraph","Properties":{"id":"20241024131048-4e6exg6","updated":"20241024131048"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.bilibili.com/video/BV13a411q753/?p=181\u0026share_source=copy_web\u0026vd_source=29909144aff7d2c1451e8d294e9a5437","TextMarkTextContent":"黑马程序员Java项目实战《瑞吉外卖》，轻松掌握springboot + mybatis plus开发核心技术的真java实战项目"}]},{"ID":"20241024131049-bjj769b","Type":"NodeParagraph","Properties":{"id":"20241024131049-bjj769b","updated":"20241024131049"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.bilibili.com/video/BV1HP4118797/?p=13\u0026share_source=copy_web\u0026vd_source=29909144aff7d2c1451e8d294e9a5437","TextMarkTextContent":"黑马程序员Docker快速入门到项目部署，MySQL部署+Nginx部署+docker自定义镜像+DockerCompose项目实战一套搞定"}]}]},{"ID":"20241024131050-bd43hoe","Type":"NodeParagraph","Properties":{"id":"20241024131050-bd43hoe","updated":"20241024131050"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"hmall-portal"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"hmall-admin"},{"Type":"NodeText","Data":"是前端代码，需要基于nginx部署。在课前资料中已经给大家提供了nginx的部署目录："}]},{"ID":"20241024131051-ehbsa75","Type":"NodeParagraph","Properties":{"id":"20241024131051-ehbsa75","updated":"20241024131051"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"img","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/169943540749216-20241024131201-aam4z0k.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131052-vvmf3xw","Type":"NodeParagraph","Properties":{"id":"20241024131052-vvmf3xw","updated":"20241024131052"},"Children":[{"Type":"NodeText","Data":"其中："}]},{"ID":"20241024131053-mun8ek9","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131053-mun8ek9","updated":"20241024131053"},"Children":[{"ID":"20241024131054-so0k1sw","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131054-so0k1sw","updated":"20241024131054"},"Children":[{"ID":"20241024131055-7u5x0sb","Type":"NodeParagraph","Properties":{"id":"20241024131055-7u5x0sb","updated":"20241024131055"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"html"},{"Type":"NodeText","Data":"是静态资源目录，我们需要把"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"hmall-portal"},{"Type":"NodeText","Data":"以及"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"hmall-admin"},{"Type":"NodeText","Data":"都复制进去"}]}]},{"ID":"20241024131056-ltagh8z","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131056-ltagh8z","updated":"20241024131056"},"Children":[{"ID":"20241024131057-gr1uzln","Type":"NodeParagraph","Properties":{"id":"20241024131057-gr1uzln","updated":"20241024131057"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"nginx.conf"},{"Type":"NodeText","Data":"是nginx的配置文件，主要是完成对"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"html"},{"Type":"NodeText","Data":"下的两个静态资源目录做代理"}]}]}]},{"ID":"20241024131058-zb8l83y","Type":"NodeParagraph","Properties":{"id":"20241024131058-zb8l83y","updated":"20241024131058"},"Children":[{"Type":"NodeText","Data":"我们现在要做的就是把整个nginx目录上传到虚拟机的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"/root"},{"Type":"NodeText","Data":"目录下："}]},{"ID":"20241024131059-ga5arm8","Type":"NodeParagraph","Properties":{"id":"20241024131059-ga5arm8","updated":"20241024131059"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"img","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/169943540749217-20241024131201-uozrymn.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131060-g3pl4ep","Type":"NodeParagraph","Properties":{"id":"20241024131060-g3pl4ep","updated":"20241024131060"},"Children":[{"Type":"NodeText","Data":"然后创建nginx容器并完成两个挂载："}]},{"ID":"20241024131061-8gkte4a","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131061-8gkte4a","updated":"20241024131061"},"Children":[{"ID":"20241024131062-i6c5iea","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131062-i6c5iea","updated":"20241024131062"},"Children":[{"ID":"20241024131063-fhnhmf5","Type":"NodeParagraph","Properties":{"id":"20241024131063-fhnhmf5","updated":"20241024131063"},"Children":[{"Type":"NodeText","Data":"把"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"/root/nginx/nginx.conf"},{"Type":"NodeText","Data":"挂载到"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"/etc/nginx/nginx.conf"}]}]},{"ID":"20241024131064-ru15int","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131064-ru15int","updated":"20241024131064"},"Children":[{"ID":"20241024131065-kgcxjxk","Type":"NodeParagraph","Properties":{"id":"20241024131065-kgcxjxk","updated":"20241024131065"},"Children":[{"Type":"NodeText","Data":"把"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"/root/nginx/html"},{"Type":"NodeText","Data":"挂载到"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"/usr/share/nginx/html"}]}]}]},{"ID":"20241024131066-41x25an","Type":"NodeParagraph","Properties":{"id":"20241024131066-41x25an","updated":"20241024131066"},"Children":[{"Type":"NodeText","Data":"由于需要让nginx同时代理hmall-portal和hmall-admin两套前端资源，因此我们需要暴露两个端口："}]},{"ID":"20241024131067-a9blhzy","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131067-a9blhzy","updated":"20241024131067"},"Children":[{"ID":"20241024131068-pk6aqn4","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131068-pk6aqn4","updated":"20241024131068"},"Children":[{"ID":"20241024131069-xjq8748","Type":"NodeParagraph","Properties":{"id":"20241024131069-xjq8748","updated":"20241024131069"},"Children":[{"Type":"NodeText","Data":"18080：对应hmall-portal"}]}]},{"ID":"20241024131070-gha43tv","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241024131070-gha43tv","updated":"20241024131070"},"Children":[{"ID":"20241024131071-dq2rsps","Type":"NodeParagraph","Properties":{"id":"20241024131071-dq2rsps","updated":"20241024131071"},"Children":[{"Type":"NodeText","Data":"18081：对应hmall-admin"}]}]}]},{"ID":"20241024131072-5du3iy5","Type":"NodeParagraph","Properties":{"id":"20241024131072-5du3iy5","updated":"20241024131072"},"Children":[{"Type":"NodeText","Data":"命令如下："}]},{"ID":"20241024131073-l8y464d","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"QmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131073-l8y464d","updated":"20241024131073"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"QmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"docker run -d \\\n  --name nginx \\\n  -p 18080:18080 \\\n  -p 18081:18081 \\\n  -v /root/nginx/html:/usr/share/nginx/html \\\n  -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf \\\n  --network hmall \\\n  nginx\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131074-wmlyqfb","Type":"NodeParagraph","Properties":{"id":"20241024131074-wmlyqfb","updated":"20241024131074"},"Children":[{"Type":"NodeText","Data":"测试，通过浏览器访问：http://你的虚拟机ip:18080"}]},{"ID":"20241024131075-s1nat1z","Type":"NodeParagraph","Properties":{"id":"20241024131075-s1nat1z","updated":"20241024131075"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"img","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/169943540749218-20241024131201-2jibxv7.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131076-lnhfm27","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241024131076-lnhfm27","updated":"20241024131076"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"一个简单的项目"}]},{"ID":"20241024131077-r1nt3f6","Type":"NodeParagraph","Properties":{"id":"20241024131077-r1nt3f6","updated":"20241024131077"},"Children":[{"Type":"NodeText","Data":"在本地虚拟机，在Docker中部署Nginx。"}]},{"ID":"20241024131078-kgvm0im","Type":"NodeParagraph","Properties":{"id":"20241024131078-kgvm0im","updated":"20241024131078"},"Children":[{"Type":"NodeText","Data":"1、首先当然是准备好项目："}]},{"ID":"20241024131079-5swsgjp","Type":"NodeParagraph","Properties":{"id":"20241024131079-5swsgjp","updated":"20241024131079"},"Children":[{"Type":"NodeText","Data":"这个项目很简单，静态文件要放在 html 目录下"}]},{"ID":"20241024131080-ehlpmj2","Type":"NodeParagraph","Properties":{"id":"20241024131080-ehlpmj2","updated":"20241024131080"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231110233856502","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231110233856502-20241024131201-csgujso.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131081-b2sgxsk","Type":"NodeParagraph","Properties":{"id":"20241024131081-b2sgxsk","updated":"20241024131081"},"Children":[{"Type":"NodeText","Data":"2、在本地准备好 nginx.conf 文件，具体还要根据你的项目来："}]},{"ID":"20241024131082-opcjq3s","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bmdpbng=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131082-opcjq3s","updated":"20241024131082"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bmdpbng=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"worker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/json;\n\n    sendfile        on;\n\n    keepalive_timeout  65;\n\n    server {\n        # 监听的端口\n        listen       18080;\n\n        # 指定前端项目所在的位置\n        location / {\n            # 这个是容器内的地址，这个地址后面会跟宿主机的一个目录挂载（在创建容器的时候使用命令）\n            root /usr/share/nginx/html;\n            # 这个是默认访问的页面，可以自己配\n            index ditu.html;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131083-89ayeul","Type":"NodeParagraph","Properties":{"id":"20241024131083-89ayeul","updated":"20241024131083"},"Children":[{"Type":"NodeText","Data":"3、然后把项目的 html 目录和 nginx.conf 文件都上传到服务器上去，可以用终端的左边，直接找到相应的目录拖动上传的。"}]},{"ID":"20241024131084-in1p7p1","Type":"NodeParagraph","Properties":{"id":"20241024131084-in1p7p1","updated":"20241024131084"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231110235045113","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231110235045113-20241024131201-os0dfhb.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131085-d1qi855","Type":"NodeParagraph","Properties":{"id":"20241024131085-d1qi855","updated":"20241024131085"},"Children":[{"Type":"NodeText","Data":"3、编写 Docker 指令："}]},{"ID":"20241024131086-ndxuor6","Type":"NodeParagraph","Properties":{"id":"20241024131086-ndxuor6","updated":"20241024131086"},"Children":[{"Type":"NodeText","Data":"这个可以去官网上看："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://hub.docker.com/_/nginx","TextMarkTextContent":"nginx - Official Image | Docker Hub"}]},{"ID":"20241024131087-0y85cl3","Type":"NodeParagraph","Properties":{"id":"20241024131087-0y85cl3","updated":"20241024131087"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231110231022772","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231110231022772-20241024131201-6yl8iy6.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131088-sco30yj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131088-sco30yj","updated":"20241024131088"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"docker run -d \\\n  --name nginx1 \\\n  -p 18080:18080 \\\n  -v /mydata/nginx/nginx1/html:/usr/share/nginx/html \\\n  -v /mydata/nginx/nginx1/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131089-b70qj5h","Type":"NodeParagraph","Properties":{"id":"20241024131089-b70qj5h","updated":"20241024131089"},"Children":[{"Type":"NodeText","Data":"然后查看运行中的容器："}]},{"ID":"20241024131090-ft2sjd5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131090-ft2sjd5","updated":"20241024131090"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"docker ps\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131091-crur1wh","Type":"NodeParagraph","Properties":{"id":"20241024131091-crur1wh","updated":"20241024131091"},"Children":[{"Type":"NodeText","Data":"不出意外的话应该就能运行了，但是我第一次部署时，发现容器并没有运行，用下面这个命令查看日志："}]},{"ID":"20241024131092-nfatofm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131092-nfatofm","updated":"20241024131092"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"[root@bogon /]# docker logs -f nginx\nError response from daemon: No such container: nginx\n[root@bogon /]# docker logs -f nginx1\n/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration\n/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh\n10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf\n10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf\n/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh\n/docker-entrypoint.sh: Configuration complete; ready for start up\n2023/11/10 15:21:34 [emerg] 1#1: unexpected \"}\" in /etc/nginx/nginx.conf:26\nnginx: [emerg] unexpected \"}\" in /etc/nginx/nginx.conf:26\n/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration\n/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh\n10-listen-on-ipv6-by-default.sh: info: IPv6 listen already enabled\n/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh\n/docker-entrypoint.sh: Configuration complete; ready for start up\n2023/11/10 15:24:17 [emerg] 1#1: unexpected \"}\" in /etc/nginx/nginx.conf:26\nnginx: [emerg] unexpected \"}\" in /etc/nginx/nginx.conf:26\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131093-1btjr43","Type":"NodeParagraph","Properties":{"id":"20241024131093-1btjr43","updated":"20241024131093"},"Children":[{"Type":"NodeText","Data":"可以看见错误是少了分号，去我们挂载的目录中，打开 nginx.conf 修改："}]},{"ID":"20241024131094-oc3qmor","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131094-oc3qmor","updated":"20241024131094"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"[root@bogon /]# cd /mydata/nginx/nginx1/\n[root@bogon nginx1]#\n[root@bogon nginx1]# vim nginx.conf\n[root@bogon nginx1]#\n[root@bogon nginx1]# docker start nginx1\nnginx1\n[root@bogon nginx1]# docker ps\nCONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                                   NAMES\n31208b28685b   nginx     \"/docker-entrypoint.…\"   9 minutes ago   Up 5 seconds   80/tcp, 0.0.0.0:18080-\u003e18080/tcp, :::18080-\u003e18080/tcp   nginx1\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131095-qsns15y","Type":"NodeParagraph","Properties":{"id":"20241024131095-qsns15y","updated":"20241024131095"},"Children":[{"Type":"NodeText","Data":"然后重新启动容器，可以发现容器成功运行了。"}]},{"ID":"20241024131096-c0f6gxo","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241024131096-c0f6gxo","updated":"20241024131096"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"部署到服务器"}]},{"ID":"20241024131097-fh8b1ku","Type":"NodeParagraph","Properties":{"id":"20241024131097-fh8b1ku","updated":"20241024131097"},"Children":[{"Type":"NodeText","Data":"项目文件还是一样的，Nginx的配置文件没有改，直接上传文件。"}]},{"ID":"20241024131098-77h2qiv","Type":"NodeParagraph","Properties":{"id":"20241024131098-77h2qiv","updated":"20241024131098"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231111002046879","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231111002046879-20241024131201-jif6phr.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131099-4xpbz2n","Type":"NodeParagraph","Properties":{"id":"20241024131099-4xpbz2n","updated":"20241024131099"},"Children":[{"Type":"NodeText","Data":"注意这个命令中，宿主机的目录不一样了，要改一下："}]},{"ID":"20241024131100-88t0hv0","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131100-88t0hv0","updated":"20241024131100"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"docker run -d \\\n  --name nginx1 \\\n  -p 18080:18080 \\\n  -v /root/mydata/nginx/nginx1/html:/usr/share/nginx/html \\\n  -v /root/mydata/nginx/nginx1/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131101-47zwf22","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131101-47zwf22","updated":"20241024131101"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"docker run -d \\\n  --name birth \\\n  -p 10089:10089 \\\n  -v /root/mydata/nginx/birthday/html:/usr/share/nginx/html \\\n  -v /root/mydata/nginx/birthday/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131102-8a819hm","Type":"NodeParagraph","Properties":{"id":"20241024131102-8a819hm","updated":"20241024131102"},"Children":[{"Type":"NodeText","Data":"记得要放行端口："}]},{"ID":"20241024131103-sa2yr6x","Type":"NodeParagraph","Properties":{"id":"20241024131103-sa2yr6x","updated":"20241024131103"},"Children":[{"Type":"NodeText","Data":"可以参考："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://bbs.huaweicloud.com/blogs/355312#:~:text=协议端口：选TCP，端口填8888 类型：IPv4 源地址：选IP地址，填0.0.0.0%2F0,上述安全组规则的意思是将8888端口放行给所有IPv4地址使用。 然后点“确定”即可生效，不需要重启云服务器。 至此华为云服务器安全组开启端口教程完毕，开启8888端口就填8888，开启80端口就填80。","TextMarkTextContent":"华为云服务器安全组开放端口图文教程（配置安全组规则开启端口）-云社区-华为云 (huaweicloud.com)"}]},{"ID":"20241024131104-jzfyui9","Type":"NodeParagraph","Properties":{"id":"20241024131104-jzfyui9","updated":"20241024131104"},"Children":[{"Type":"NodeText","Data":"修改安全组："}]},{"ID":"20241024131105-tqmjof8","Type":"NodeParagraph","Properties":{"id":"20241024131105-tqmjof8","updated":"20241024131105"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231111001727047","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231111001727047-20241024131201-cu6k6l1.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131106-td3udfa","Type":"NodeParagraph","Properties":{"id":"20241024131106-td3udfa","updated":"20241024131106"},"Children":[{"Type":"NodeText","Data":"对ipv4放行18080端口，允许的地址选0.0.0.0/0，就是所有地址"}]},{"ID":"20241024131107-oz65zb1","Type":"NodeParagraph","Properties":{"id":"20241024131107-oz65zb1","updated":"20241024131107"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231111001616487","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231111001616487-20241024131201-qf7m6bo.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131108-zp6by3g","Type":"NodeParagraph","Properties":{"id":"20241024131108-zp6by3g","updated":"20241024131108"},"Children":[{"Type":"NodeText","Data":"然后打开浏览器就可以了。"}]},{"ID":"20241024131109-zvx5r9h","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241024131109-zvx5r9h","updated":"20241024131340"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"zhiyuan"}]},{"ID":"20241024131110-vtsik5m","Type":"NodeParagraph","Properties":{"id":"20241024131110-vtsik5m","updated":"20241024131110"},"Children":[{"Type":"NodeText","Data":"之前的"}]},{"ID":"20241024131111-1hta2wv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bmdpbng=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131111-1hta2wv","updated":"20241024131111"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bmdpbng=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"worker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/json;\n\n    sendfile        on;\n\n    keepalive_timeout  65;\n\n    server {\n        # 监听的端口\n        listen       18080;\n\n        # 指定前端项目所在的位置\n        location / {\n            # 这个是容器内的地址，这个地址后面会跟宿主机的一个目录挂载（在创建容器的时候使用命令）\n            root /usr/share/nginx/html;\n            # 这个是默认访问的页面，可以自己配\n            index ditu.html;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131112-t48vabz","Type":"NodeParagraph","Properties":{"id":"20241024131112-t48vabz","updated":"20241024131112"},"Children":[{"Type":"NodeText","Data":"这次的（本地）："}]},{"ID":"20241024131113-fyvxkfs","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bmdpbng=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131113-fyvxkfs","updated":"20241024131113"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bmdpbng=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\n#user  nobody;\nworker_processes  1;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n\n#pid        logs/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       8090;\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n        #\n        #location ~ \\.php$ {\n        #    proxy_pass   http://127.0.0.1;\n        #}\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        #\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # deny access to .htaccess files, if Apache's document root\n        # concurs with nginx's one\n        #\n        #location ~ /\\.ht {\n        #    deny  all;\n        #}\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131114-1ktnjq9","Type":"NodeParagraph","Properties":{"id":"20241024131114-1ktnjq9","updated":"20241024131114"},"Children":[{"Type":"NodeText","Data":"云端："}]},{"ID":"20241024131115-i4kjd4u","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241024131115-i4kjd4u","linewrap":"true","updated":"20241024131329"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bmdpbng="},{"Type":"NodeCodeBlockCode","Data":"worker_processes  1;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       8091;\n        # 这里要注释了\n        # server_name  localhost;\n\n        location / {\n            # 这个是容器内的地址，这个地址后面会跟宿主机的一个目录挂载（在创建容器的时候使用命令）\n            root   /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        location /api {\n            # 把/api换了\n            rewrite /api/(.*) /$1 break;\n            # localhost改成主机的IP\n            proxy_pass http://localhost:8080;\n        }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241024131116-c1wmiba","Type":"NodeParagraph","Properties":{"id":"20241024131116-c1wmiba","updated":"20241024131116"},"Children":[{"Type":"NodeText","Data":"这个供参考：可以代理多个网页"}]},{"ID":"20241024131117-z4sa913","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bmdpbng=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131117-z4sa913","updated":"20241024131117"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bmdpbng=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/json;\n\n    sendfile        on;\n    \n    keepalive_timeout  65;\n\n    server {\n        listen       18080;\n        # 指定前端项目所在的位置\n        location / {\n            root /usr/share/nginx/html/hmall-portal;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n        location /api {\n            rewrite /api/(.*)  /$1 break;\n            proxy_pass http://hmall:8080;\n        }\n    }\n    server {\n        listen       18081;\n        # 指定前端项目所在的位置\n        location / {\n            root /usr/share/nginx/html/hmall-admin;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n        location /api {\n            rewrite /api/(.*)  /$1 break;\n            proxy_pass http://hmall:8080;\n        }\n    }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131118-50jjsbb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241024131118-50jjsbb","updated":"20241024131118"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"docker run -d \\\n  --name nginx_zhiyuan_b \\\n  -p 8091:8091 \\\n  -v /root/mydata/nginx/nginx_zhiyuan_backend/html:/usr/share/nginx/html \\\n  -v /root/mydata/nginx/nginx_zhiyuan_backend/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241024131119-oyz62l3","Type":"NodeParagraph","Properties":{"id":"20241024131119-oyz62l3","updated":"20241024131119"},"Children":[{"Type":"NodeText","Data":"注意改后端的地址："}]},{"ID":"20241024131120-95ch280","Type":"NodeParagraph","Properties":{"id":"20241024131120-95ch280","updated":"20241024131120"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20231223172853040","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/image-20231223172853040-20241024131201-6grxjmm.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20241024131340-uv0mpgi","Type":"NodeParagraph","Properties":{"id":"20241024131340-uv0mpgi","updated":"20241024131340"}}]}