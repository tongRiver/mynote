{"ID":"20241016092105-8suywxe","Spec":"1","Type":"NodeDocument","Properties":{"id":"20241016092105-8suywxe","title":"SQL注入及预防","type":"doc","updated":"20241016160520"},"Children":[{"ID":"20241016092106-k5tvc2t","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241016092106-k5tvc2t","updated":"20241016092106"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"SQL注入"}]},{"ID":"20241016092107-mx9ny3l","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241016092107-mx9ny3l","updated":"20241016092107"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"不用密码登录"}]},{"ID":"20241016092108-5s8p6dx","Type":"NodeParagraph","Properties":{"id":"20241016092108-5s8p6dx","updated":"20241016092108"},"Children":[{"Type":"NodeText","Data":"SQL注入（SQL Injection）是一种常见的网络攻击方式，攻击者通过将恶意的SQL语句插入到应用程序的输入中，诱使后台数据库执行未经授权的操作。攻击者可以利用这种漏洞窃取、修改、删除数据库中的数据，甚至获取系统权限。SQL注入通常发生在开发者没有正确处理用户输入的情况下，导致用户提供的数据被直接拼接到SQL查询中执行。"}]},{"ID":"20241016092109-9k4tl5w","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092109-9k4tl5w","updated":"20241016092109"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"SQL注入的工作原理"}]},{"ID":"20241016092110-cqfhujs","Type":"NodeParagraph","Properties":{"id":"20241016092110-cqfhujs","updated":"20241016092110"},"Children":[{"Type":"NodeText","Data":"通常情况下，应用程序通过接受用户的输入并将其传递给数据库来执行查询。例如，假设有一个简单的用户登录系统，用户输入用户名和密码，系统会执行如下SQL查询来验证用户身份："}]},{"ID":"20241016092111-vkv3v22","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092111-vkv3v22","updated":"20241016092111"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = 'user' AND password = 'password';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092112-175b5zv","Type":"NodeParagraph","Properties":{"id":"20241016092112-175b5zv","updated":"20241016092112"},"Children":[{"Type":"NodeText","Data":"如果开发人员没有正确地处理输入，攻击者可以通过在输入中插入恶意SQL代码来篡改查询。例如，攻击者输入以下用户名和密码："}]},{"ID":"20241016092113-9w2auhp","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092113-9w2auhp","updated":"20241016092113"},"Children":[{"ID":"20241016092114-4cpuf42","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092114-4cpuf42","updated":"20241016092114"},"Children":[{"ID":"20241016092115-uh1sc57","Type":"NodeParagraph","Properties":{"id":"20241016092115-uh1sc57","updated":"20241016092115"},"Children":[{"Type":"NodeText","Data":"用户名："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' OR '1'='1"}]}]},{"ID":"20241016092116-7x6lzil","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092116-7x6lzil","updated":"20241016092116"},"Children":[{"ID":"20241016092117-q9hrorr","Type":"NodeParagraph","Properties":{"id":"20241016092117-q9hrorr","updated":"20241016092117"},"Children":[{"Type":"NodeText","Data":"密码："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' OR '1'='1"}]}]}]},{"ID":"20241016092118-8xs0dh5","Type":"NodeParagraph","Properties":{"id":"20241016092118-8xs0dh5","updated":"20241016092118"},"Children":[{"Type":"NodeText","Data":"这样生成的SQL查询语句可能变成："}]},{"ID":"20241016092119-baeoab2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092119-baeoab2","updated":"20241016092119"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = '' OR '1'='1' AND password = '' OR '1'='1';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092120-9lu9n3k","Type":"NodeParagraph","Properties":{"id":"20241016092120-9lu9n3k","updated":"20241016092120"},"Children":[{"Type":"NodeText","Data":"这段SQL会始终返回“真”（"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"1=1"},{"Type":"NodeText","Data":"永远为真），导致应用程序认为登录验证成功，从而允许攻击者未经授权地登录系统。"}]},{"ID":"20241016092121-ylwgxvw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092121-ylwgxvw","updated":"20241016092121"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"SQL注入的类型"}]},{"ID":"20241016092122-v1s5qz5","Type":"NodeParagraph","Properties":{"id":"20241016092122-v1s5qz5","updated":"20241016092122"},"Children":[{"Type":"NodeText","Data":"SQL注入有多种类型，常见的包括："}]},{"ID":"20241016092123-nahujtl","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092123-nahujtl","updated":"20241016092123"},"Children":[{"ID":"20241016092124-kamzky9","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092124-kamzky9","updated":"20241016092124"},"Children":[{"ID":"20241016092125-9et76se","Type":"NodeParagraph","Properties":{"id":"20241016092125-9et76se","updated":"20241016092125"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"基于错误的SQL注入"},{"Type":"NodeText","Data":"：通过输入恶意SQL，诱导服务器返回数据库错误信息，从中获取系统内部信息。"}]}]},{"ID":"20241016092126-zcswm4n","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092126-zcswm4n","updated":"20241016092126"},"Children":[{"ID":"20241016092127-6dps4m3","Type":"NodeParagraph","Properties":{"id":"20241016092127-6dps4m3","updated":"20241016092127"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"盲注（Blind SQL Injection）"},{"Type":"NodeText","Data":"：攻击者无法直接看到数据库的响应，但通过观察应用程序的行为（如页面加载是否正常）来推测数据库的状态。"}]}]},{"ID":"20241016092128-nn4swvh","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20241016092128-nn4swvh","updated":"20241016092128"},"Children":[{"ID":"20241016092129-6y5we6s","Type":"NodeParagraph","Properties":{"id":"20241016092129-6y5we6s","updated":"20241016092129"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"基于时间的盲注"},{"Type":"NodeText","Data":"：通过控制查询执行时间来推断数据库返回的结果。"}]}]},{"ID":"20241016092130-ebzuodc","Type":"NodeListItem","Data":"4","ListData":{"Typ":1,"Tight":true,"Start":4,"Delimiter":46,"Padding":3,"Marker":"NA==","Num":4},"Properties":{"id":"20241016092130-ebzuodc","updated":"20241016092130"},"Children":[{"ID":"20241016092131-1we2yg5","Type":"NodeParagraph","Properties":{"id":"20241016092131-1we2yg5","updated":"20241016092131"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"联合查询注入（UNION-based SQL Injection）"},{"Type":"NodeText","Data":"：利用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"UNION"},{"Type":"NodeText","Data":"关键字合并多个查询的结果，从而读取额外的数据。"}]}]}]},{"ID":"20241016092132-8ua31gr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092132-8ua31gr","updated":"20241016092132"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"如何防止SQL注入"}]},{"ID":"20241016092133-fc5ld45","Type":"NodeList","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092133-fc5ld45","updated":"20241016092133"},"Children":[{"ID":"20241016092134-wn1oazm","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092134-wn1oazm","updated":"20241016092134"},"Children":[{"ID":"20241016092135-alyaal4","Type":"NodeParagraph","Properties":{"id":"20241016092135-alyaal4","updated":"20241016092135"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"使用预编译语句（Prepared Statements）"},{"Type":"NodeText","Data":"：也叫参数化查询，将用户输入作为参数传递，避免直接拼接SQL语句。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"例如，在使用Python的SQLAlchemy或MySQL的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"mysqli"},{"Type":"NodeText","Data":"时，可以通过绑定参数来确保安全。"}]},{"ID":"20241016092136-8f5vsds","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cHl0aG9u","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092136-8f5vsds","updated":"20241016092136"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"cursor.execute(\"SELECT * FROM users WHERE username = %s AND password = %s\", \n               (username, password))\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20241016092137-n18y4hj","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092137-n18y4hj","updated":"20241016092137"},"Children":[{"ID":"20241016092138-ikzb5nt","Type":"NodeParagraph","Properties":{"id":"20241016092138-ikzb5nt","updated":"20241016092138"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"使用ORM框架"},{"Type":"NodeText","Data":"：如Django ORM或Hibernate，它们抽象了SQL查询，减少了手动编写SQL语句的机会，从而降低了SQL注入风险。"}]}]},{"ID":"20241016092139-9d94xmt","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20241016092139-9d94xmt","updated":"20241016092139"},"Children":[{"ID":"20241016092140-vulq19o","Type":"NodeParagraph","Properties":{"id":"20241016092140-vulq19o","updated":"20241016092140"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"输入校验与过滤"},{"Type":"NodeText","Data":"：对用户输入的数据进行严格的校验和过滤，限制特殊字符的使用，防止注入攻击。"}]}]},{"ID":"20241016092141-jzh6eid","Type":"NodeListItem","Data":"4","ListData":{"Typ":1,"Tight":true,"Start":4,"Delimiter":46,"Padding":3,"Marker":"NA==","Num":4},"Properties":{"id":"20241016092141-jzh6eid","updated":"20241016092141"},"Children":[{"ID":"20241016092142-8g06e8k","Type":"NodeParagraph","Properties":{"id":"20241016092142-8g06e8k","updated":"20241016092142"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"最小权限原则"},{"Type":"NodeText","Data":"：数据库的用户权限应限制在最小范围，避免赋予应用程序过多的数据库操作权限，降低被利用的风险。"}]}]},{"ID":"20241016092143-l89lcwn","Type":"NodeListItem","Data":"5","ListData":{"Typ":1,"Tight":true,"Start":5,"Delimiter":46,"Padding":3,"Marker":"NQ==","Num":5},"Properties":{"id":"20241016092143-l89lcwn","updated":"20241016092143"},"Children":[{"ID":"20241016092144-c69ymzr","Type":"NodeParagraph","Properties":{"id":"20241016092144-c69ymzr","updated":"20241016092144"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"定期安全测试"},{"Type":"NodeText","Data":"：通过安全扫描工具检测SQL注入漏洞，及时修复安全隐患。"}]}]}]},{"ID":"20241016092145-xrjzhr9","Type":"NodeParagraph","Properties":{"id":"20241016092145-xrjzhr9","updated":"20241016092145"},"Children":[{"Type":"NodeText","Data":"总之，SQL注入是由于应用程序没有正确处理用户输入而导致的一种严重的安全漏洞。通过正确地使用参数化查询、输入校验和最小权限原则等措施，可以有效防止SQL注入攻击。"}]},{"ID":"20241016092146-cr5x926","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241016092146-cr5x926","updated":"20241016092146"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"删除数据库"}]},{"ID":"20241016092147-gwk78ou","Type":"NodeParagraph","Properties":{"id":"20241016092147-gwk78ou","updated":"20241016092147"},"Children":[{"Type":"NodeText","Data":"黑客通过SQL注入删除系统数据库的方式通常是利用应用程序中未正确处理的输入字段，向数据库发送恶意的SQL命令，执行具有破坏性的操作。具体来说，他们可能会利用SQL注入漏洞插入诸如"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE"},{"Type":"NodeText","Data":"或"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DELETE"},{"Type":"NodeText","Data":"等SQL命令，从而删除数据库中的表或清空表中的数据。"}]},{"ID":"20241016092148-npk3e61","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092148-npk3e61","updated":"20241016092148"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"黑客利用SQL注入删除数据库的步骤"}]},{"ID":"20241016092149-2djnqtl","Type":"NodeList","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092149-2djnqtl","updated":"20241016092149"},"Children":[{"ID":"20241016092150-gtqv10h","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092150-gtqv10h","updated":"20241016092150"},"Children":[{"ID":"20241016092151-q3pz5m4","Type":"NodeParagraph","Properties":{"id":"20241016092151-q3pz5m4","updated":"20241016092151"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"识别SQL注入点"},{"Type":"NodeText","Data":"：首先，黑客需要找到一个可以注入恶意SQL的输入点，例如登录表单、搜索框或者其他接受用户输入的地方。如果应用程序直接将用户输入拼接到SQL查询中，而没有进行适当的过滤或转义，这就是潜在的攻击点。"}]}]},{"ID":"20241016092152-nuzjr80","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092152-nuzjr80","updated":"20241016092152"},"Children":[{"ID":"20241016092153-ix61kxc","Type":"NodeParagraph","Properties":{"id":"20241016092153-ix61kxc","updated":"20241016092153"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"构造恶意的SQL语句"},{"Type":"NodeText","Data":"：黑客可以通过插入恶意代码，将合法的SQL查询修改成破坏性的SQL命令。例如，假设应用程序执行以下SQL查询来查找用户名："}]},{"ID":"20241016092154-0kbrvrb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092154-0kbrvrb","updated":"20241016092154"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = 'user';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092155-x6ptfxy","Type":"NodeParagraph","Properties":{"id":"20241016092155-x6ptfxy","updated":"20241016092155"},"Children":[{"Type":"NodeText","Data":"黑客在用户名字段中输入类似于以下的内容："}]},{"ID":"20241016092156-1ewkn2x","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092156-1ewkn2x","updated":"20241016092156"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"'; DROP TABLE users; --\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092157-m2c7s2m","Type":"NodeParagraph","Properties":{"id":"20241016092157-m2c7s2m","updated":"20241016092157"},"Children":[{"Type":"NodeText","Data":"这段输入会将查询修改为："}]},{"ID":"20241016092158-ajcid3z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092158-ajcid3z","updated":"20241016092158"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = ''; DROP TABLE users; --';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092159-ht6pqxg","Type":"NodeParagraph","Properties":{"id":"20241016092159-ht6pqxg","updated":"20241016092159"},"Children":[{"Type":"NodeText","Data":"其中，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"--"},{"Type":"NodeText","Data":"是SQL中的注释符号，表示注释掉后面的内容。这意味着后面的部分不会被执行，真正执行的SQL语句为："}]},{"ID":"20241016092160-glnsegj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092160-glnsegj","updated":"20241016092160"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = ''; DROP TABLE users;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092161-q53a27b","Type":"NodeParagraph","Properties":{"id":"20241016092161-q53a27b","updated":"20241016092161"},"Children":[{"Type":"NodeText","Data":"这会导致"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"users"},{"Type":"NodeText","Data":"表被删除。"}]}]},{"ID":"20241016092162-x3wjib1","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20241016092162-x3wjib1","updated":"20241016092162"},"Children":[{"ID":"20241016092163-lp9tk68","Type":"NodeParagraph","Properties":{"id":"20241016092163-lp9tk68","updated":"20241016092163"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"利用数据库权限"},{"Type":"NodeText","Data":"：一旦攻击者成功执行了"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE"},{"Type":"NodeText","Data":"命令，表将会被删除。但这依赖于应用程序使用的数据库用户权限。如果该数据库用户拥有删除表的权限，删除操作会成功执行。如果数据库用户的权限受限，例如只能执行查询（"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT"},{"Type":"NodeText","Data":"），则删除命令不会生效。因此，过高的数据库权限是SQL注入成功的一个关键因素。"}]}]}]},{"ID":"20241016092164-5xrqscs","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092164-5xrqscs","updated":"20241016092164"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"防御措施"}]},{"ID":"20241016092165-yjymrpx","Type":"NodeList","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092165-yjymrpx","updated":"20241016092165"},"Children":[{"ID":"20241016092166-liq1qyx","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092166-liq1qyx","updated":"20241016092166"},"Children":[{"ID":"20241016092167-fwlgk9k","Type":"NodeParagraph","Properties":{"id":"20241016092167-fwlgk9k","updated":"20241016092167"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"参数化查询/预编译语句"},{"Type":"NodeText","Data":"：最有效的防止SQL注入的方式之一是使用参数化查询，将用户输入作为参数传递，而不是直接拼接SQL语句。例如："}]},{"ID":"20241016092168-5f2s2kc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cHl0aG9u","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092168-5f2s2kc","updated":"20241016092168"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"cursor.execute(\"SELECT * FROM users WHERE username = %s\", (username,))\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092169-s9f9pfq","Type":"NodeParagraph","Properties":{"id":"20241016092169-s9f9pfq","updated":"20241016092169"},"Children":[{"Type":"NodeText","Data":"这样即便攻击者输入恶意代码，数据库也不会将其解释为SQL命令。"}]}]},{"ID":"20241016092170-mhvmtir","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092170-mhvmtir","updated":"20241016092170"},"Children":[{"ID":"20241016092171-n1hfojr","Type":"NodeParagraph","Properties":{"id":"20241016092171-n1hfojr","updated":"20241016092171"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"限制数据库用户权限"},{"Type":"NodeText","Data":"：确保应用程序使用的数据库用户拥有最小权限。例如，不要让应用程序的数据库用户拥有删除表或修改数据库结构的权限。这样即使发生SQL注入，攻击者也无法删除数据库表。"}]}]},{"ID":"20241016092172-0jg6nie","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20241016092172-0jg6nie","updated":"20241016092172"},"Children":[{"ID":"20241016092173-5xwulkr","Type":"NodeParagraph","Properties":{"id":"20241016092173-5xwulkr","updated":"20241016092173"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"输入验证与过滤"},{"Type":"NodeText","Data":"：在服务器端和客户端都要对用户输入进行严格的验证。应禁止使用特殊字符，如单引号、双引号、分号等，这些字符在SQL注入攻击中经常被利用。"}]}]},{"ID":"20241016092174-pt9ofo4","Type":"NodeListItem","Data":"4","ListData":{"Typ":1,"Tight":true,"Start":4,"Delimiter":46,"Padding":3,"Marker":"NA==","Num":4},"Properties":{"id":"20241016092174-pt9ofo4","updated":"20241016092174"},"Children":[{"ID":"20241016092175-ye2vg0z","Type":"NodeParagraph","Properties":{"id":"20241016092175-ye2vg0z","updated":"20241016092175"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"安全审计与监控"},{"Type":"NodeText","Data":"：定期对系统进行安全审计，使用自动化工具检测是否存在SQL注入漏洞。还可以通过数据库的审计日志监控是否有异常的SQL执行行为，提前发现攻击迹象。"}]}]}]},{"ID":"20241016092176-85a1z8c","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092176-85a1z8c","updated":"20241016092176"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"典型示例"}]},{"ID":"20241016092177-t39qmcg","Type":"NodeParagraph","Properties":{"id":"20241016092177-t39qmcg","updated":"20241016092177"},"Children":[{"Type":"NodeText","Data":"假设有一个删除用户数据的功能，允许管理员删除特定用户的记录，执行如下SQL查询："}]},{"ID":"20241016092178-e7pj019","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092178-e7pj019","updated":"20241016092178"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"DELETE FROM users WHERE user_id = 'id';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092179-qst21kt","Type":"NodeParagraph","Properties":{"id":"20241016092179-qst21kt","updated":"20241016092179"},"Children":[{"Type":"NodeText","Data":"如果没有对"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"user_id"},{"Type":"NodeText","Data":"进行过滤，攻击者可以将"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"id"},{"Type":"NodeText","Data":"字段设置为："}]},{"ID":"20241016092180-gbn0ysv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092180-gbn0ysv","updated":"20241016092180"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"' OR '1'='1'; DROP TABLE users; --\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092181-dr90shl","Type":"NodeParagraph","Properties":{"id":"20241016092181-dr90shl","updated":"20241016092181"},"Children":[{"Type":"NodeText","Data":"这将生成以下SQL语句："}]},{"ID":"20241016092182-e19b1yp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092182-e19b1yp","updated":"20241016092182"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"DELETE FROM users WHERE user_id = ''; OR '1'='1'; DROP TABLE users; --\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092183-o0hpgks","Type":"NodeParagraph","Properties":{"id":"20241016092183-o0hpgks","updated":"20241016092183"},"Children":[{"Type":"NodeText","Data":"其中，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' OR '1'='1'"},{"Type":"NodeText","Data":"总是为真，删除操作会作用于所有用户。紧接着的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE users"},{"Type":"NodeText","Data":"会删除整个"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"users"},{"Type":"NodeText","Data":"表。"}]},{"ID":"20241016092184-9ztq53s","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092184-9ztq53s","updated":"20241016092184"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"总结"}]},{"ID":"20241016092185-0xb3ok8","Type":"NodeParagraph","Properties":{"id":"20241016092185-0xb3ok8","updated":"20241016092185"},"Children":[{"Type":"NodeText","Data":"通过SQL注入删除数据库是非常严重的攻击，可能导致数据的不可逆损失。防范SQL注入的核心是："}]},{"ID":"20241016092186-zmqewne","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092186-zmqewne","updated":"20241016092186"},"Children":[{"ID":"20241016092187-33w6tqc","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092187-33w6tqc","updated":"20241016092187"},"Children":[{"ID":"20241016092188-nx1oqlv","Type":"NodeParagraph","Properties":{"id":"20241016092188-nx1oqlv","updated":"20241016092188"},"Children":[{"Type":"NodeText","Data":"使用参数化查询/预编译语句"}]}]},{"ID":"20241016092189-avcpgp0","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092189-avcpgp0","updated":"20241016092189"},"Children":[{"ID":"20241016092190-xzxzzlk","Type":"NodeParagraph","Properties":{"id":"20241016092190-xzxzzlk","updated":"20241016092190"},"Children":[{"Type":"NodeText","Data":"限制数据库权限"}]}]},{"ID":"20241016092191-fj5jbmi","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092191-fj5jbmi","updated":"20241016092191"},"Children":[{"ID":"20241016092192-i2844on","Type":"NodeParagraph","Properties":{"id":"20241016092192-i2844on","updated":"20241016092192"},"Children":[{"Type":"NodeText","Data":"验证和过滤用户输入"}]}]},{"ID":"20241016092193-06uku4z","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092193-06uku4z","updated":"20241016092193"},"Children":[{"ID":"20241016092194-xkd368g","Type":"NodeParagraph","Properties":{"id":"20241016092194-xkd368g","updated":"20241016092194"},"Children":[{"Type":"NodeText","Data":"定期进行安全检测和日志监控"}]}]}]},{"ID":"20241016092195-0a8nr27","Type":"NodeParagraph","Properties":{"id":"20241016092195-0a8nr27","updated":"20241016092195"},"Children":[{"Type":"NodeText","Data":"采取这些措施可以有效防止攻击者通过SQL注入删除数据库或进行其他破坏性操作。"}]},{"ID":"20241016092196-wmnif53","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092196-wmnif53","updated":"20241016093400"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"分号后面的也会执行"}]},{"ID":"20241016092197-g7drwop","Type":"NodeParagraph","Properties":{"id":"20241016092197-g7drwop","updated":"20241016092197"},"Children":[{"Type":"NodeText","Data":"但是在"}]},{"ID":"20241016092198-jmsyype","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"U1FM","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092198-jmsyype","updated":"20241016092198"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"U1FM","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = ''; DROP TABLE users; --';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092199-bnihzvm","Type":"NodeParagraph","Properties":{"id":"20241016092199-bnihzvm","updated":"20241016092199"},"Children":[{"Type":"NodeText","Data":"中，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT * FROM users WHERE username = ''; "},{"Type":"NodeText","Data":"不会查到结果，那么后面的部分还会执行吗？"}]},{"ID":"20241016092200-imoyhid","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092200-imoyhid","updated":"20241016093400"},"Children":[{"ID":"20241016092201-tohubwo","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092201-tohubwo","updated":"20241016093400"},"Children":[{"ID":"20241016092202-tos4x4c","Type":"NodeParagraph","Properties":{"id":"20241016092202-tos4x4c","updated":"20241016092202"},"Children":[{"Type":"NodeText","Data":"这是一个非常好的问题。为了回答这个问题，我们需要了解SQL语句的执行方式以及不同数据库管理系统（DBMS）对SQL语句的处理机制。"}]},{"ID":"20241016092203-hogekt7","Type":"NodeParagraph","Properties":{"id":"20241016092203-hogekt7","updated":"20241016092203"},"Children":[{"Type":"NodeText","Data":"在SQL注入攻击中，尽管前面的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT"},{"Type":"NodeText","Data":"查询没有返回结果，但如果攻击者成功构造了一条包含多条语句的SQL查询，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"不同的数据库系统可能仍然会执行后面的语句"},{"Type":"NodeText","Data":"。通常情况下，数据库在执行SQL查询时，会按顺序执行语句，而不一定依赖于前一条语句的结果是否返回数据。"}]},{"ID":"20241016092204-5ht4o40","Type":"NodeParagraph","Properties":{"id":"20241016092204-5ht4o40","updated":"20241016092204"},"Children":[{"Type":"NodeText","Data":"让我们拆解你提到的SQL查询："}]},{"ID":"20241016092205-kot9lzx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092205-kot9lzx","updated":"20241016092205"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = ''; DROP TABLE users; --';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092206-ja2ys9b","Type":"NodeParagraph","Properties":{"id":"20241016092206-ja2ys9b","updated":"20241016092206"},"Children":[{"Type":"NodeText","Data":"这里有两条SQL语句："}]},{"ID":"20241016092207-quvmcp4","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092207-quvmcp4","updated":"20241016092207"},"Children":[{"ID":"20241016092208-fw3ur0h","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092208-fw3ur0h","updated":"20241016092208"},"Children":[{"ID":"20241016092209-5srb5b7","Type":"NodeParagraph","Properties":{"id":"20241016092209-5srb5b7","updated":"20241016092209"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT * FROM users WHERE username = '';"}]}]},{"ID":"20241016092210-a2rf098","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092210-a2rf098","updated":"20241016092210"},"Children":[{"ID":"20241016092211-t8ra3yz","Type":"NodeParagraph","Properties":{"id":"20241016092211-t8ra3yz","updated":"20241016092211"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE users;"}]}]}]},{"ID":"20241016092212-ob8dqaa","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092212-ob8dqaa","updated":"20241016093400"},"Children":[{"ID":"20241016092213-nflytk7","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092213-nflytk7","updated":"20241016093400"},"Children":[{"ID":"20241016092214-udcoats","Type":"NodeParagraph","Properties":{"id":"20241016092214-udcoats","updated":"20241016093400"},"Children":[{"Type":"NodeText","Data":"第一条查询虽然不会查到数据（因为没有用户的用户名为空字符串"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"''"},{"Type":"NodeText","Data":"​），但它"},{"Type":"NodeTextMark","TextMarkType":"strong a","TextMarkTextContent":"并不会导致整个查询的失败"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20241016092215-3nx264g","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092215-3nx264g","updated":"20241016092215"},"Children":[{"ID":"20241016092216-45dm5wx","Type":"NodeParagraph","Properties":{"id":"20241016092216-45dm5wx","updated":"20241016092216"},"Children":[{"Type":"NodeText","Data":"第二条语句，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE users;"},{"Type":"NodeText","Data":"，并不是依赖于前一条查询的结果。它是一条独立的SQL命令，因此如果数据库允许执行多条SQL语句（即"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"多语句查询"},{"Type":"NodeText","Data":"），这条删除命令仍然会被执行。"}]}]}]},{"ID":"20241016092217-j8km38b","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092217-j8km38b","updated":"20241016092217"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"取决于数据库系统的行为"}]},{"ID":"20241016092218-u1xowit","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092218-u1xowit","updated":"20241016092218"},"Children":[{"ID":"20241016092219-w5vnvxx","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092219-w5vnvxx","updated":"20241016092219"},"Children":[{"ID":"20241016092220-83su3jf","Type":"NodeParagraph","Properties":{"id":"20241016092220-83su3jf","updated":"20241016092220"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"某些数据库系统"},{"Type":"NodeText","Data":"（如MySQL）默认情况下允许在一个请求中执行多条SQL语句。这种情况下，即使第一条查询没有结果，后面的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE users;"},{"Type":"NodeText","Data":"语句仍然会被执行。"}]},{"ID":"20241016092221-mfahueh","Type":"NodeParagraph","Properties":{"id":"20241016092221-mfahueh","updated":"20241016092221"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"MySQL示例"},{"Type":"NodeText","Data":"：如果配置中允许多语句查询（通过"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"multi_statements"},{"Type":"NodeText","Data":"设置），那么后面的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE"},{"Type":"NodeText","Data":"仍会被执行。"}]}]},{"ID":"20241016092222-d0xhbiy","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092222-d0xhbiy","updated":"20241016092222"},"Children":[{"ID":"20241016092223-5lsu4h0","Type":"NodeParagraph","Properties":{"id":"20241016092223-5lsu4h0","updated":"20241016092223"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"某些数据库系统"},{"Type":"NodeText","Data":"（如SQL Server）不允许通过一个请求执行多个SQL语句，除非使用特定的语法或者在数据库配置中开启相关选项。因此，在这种情况下，注入攻击可能无法通过这种方式删除表。"}]},{"ID":"20241016092224-y15ae9z","Type":"NodeParagraph","Properties":{"id":"20241016092224-y15ae9z","updated":"20241016092224"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"SQL Server示例"},{"Type":"NodeText","Data":"：默认不允许多个SQL语句通过同一个查询执行，因此攻击者需要寻找其他SQL注入方式，比如使用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"UNION"},{"Type":"NodeText","Data":"或其他漏洞。"}]}]}]},{"ID":"20241016092225-pnm7wmi","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092225-pnm7wmi","updated":"20241016092225"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"防御多语句攻击"}]},{"ID":"20241016092226-jy0jccc","Type":"NodeParagraph","Properties":{"id":"20241016092226-jy0jccc","updated":"20241016092226"},"Children":[{"Type":"NodeText","Data":"为了防止这种情况，除了前面提到的预编译语句、参数化查询外，还有一些具体措施："}]},{"ID":"20241016092227-zdt44v1","Type":"NodeList","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092227-zdt44v1","updated":"20241016092227"},"Children":[{"ID":"20241016092228-hrwy04n","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092228-hrwy04n","updated":"20241016092228"},"Children":[{"ID":"20241016092229-4c1e9di","Type":"NodeParagraph","Properties":{"id":"20241016092229-4c1e9di","updated":"20241016092229"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"禁用多语句查询"},{"Type":"NodeText","Data":"：一些数据库（如MySQL）允许通过配置禁用多语句查询。如果禁用，单个查询中包含多个SQL语句将无法执行，减少了此类SQL注入的风险。"}]}]},{"ID":"20241016092230-fv76o4v","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092230-fv76o4v","updated":"20241016092230"},"Children":[{"ID":"20241016092231-i6ktmb4","Type":"NodeParagraph","Properties":{"id":"20241016092231-i6ktmb4","updated":"20241016092231"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"审计数据库配置"},{"Type":"NodeText","Data":"：确保数据库配置符合安全最佳实践，例如在不需要的情况下禁用多语句查询，限制对关键数据库对象的删除或修改权限。"}]}]}]},{"ID":"20241016092232-pwi1umw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092232-pwi1umw","updated":"20241016092232"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"总结"}]},{"ID":"20241016092233-sndv2ei","Type":"NodeParagraph","Properties":{"id":"20241016092233-sndv2ei","updated":"20241016092233"},"Children":[{"Type":"NodeText","Data":"在很多数据库系统中，即使前面的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT"},{"Type":"NodeText","Data":"查询没有结果，后续的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"DROP TABLE"},{"Type":"NodeText","Data":"等命令依然可能被执行，具体取决于数据库的配置和语法规则。因此，为了防止此类SQL注入攻击，必须通过参数化查询和其他安全防护措施来确保用户输入无法被恶意利用。"}]}]}]},{"ID":"20241016092234-q8nibvn","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241016092234-q8nibvn","updated":"20241016092292"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"防止的方法"}]},{"ID":"20241016092235-nvsf6em","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092235-nvsf6em","updated":"20241016092292"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"参数化查询/预编译语句"}]},{"ID":"20241016092236-5ltb8u9","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092236-5ltb8u9","updated":"20241016092292"},"Children":[{"ID":"20241016092237-0oko56n","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092237-0oko56n","updated":"20241016092292"},"Children":[{"ID":"20241016092238-6se9ao7","Type":"NodeParagraph","Properties":{"id":"20241016092238-6se9ao7","updated":"20241016092238"},"Children":[{"Type":"NodeText","Data":"参数化查询（Parameterized Queries）或预编译语句（Prepared Statements）是防止SQL注入的最佳方法之一。它通过将用户输入作为参数传递给SQL查询，而不是直接将其嵌入到SQL字符串中，从根本上解决了SQL注入问题。下面我们来详细解释其工作原理及其安全机制。"}]},{"ID":"20241016092239-nv6cnq1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092239-nv6cnq1","updated":"20241016092239"},"Children":[{"Type":"NodeText","Data":"1. 什么是参数化查询/预编译语句？"}]},{"ID":"20241016092240-pvsyt3z","Type":"NodeParagraph","Properties":{"id":"20241016092240-pvsyt3z","updated":"20241016092240"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"参数化查询"},{"Type":"NodeText","Data":"是一种将SQL查询中的动态部分（如用户输入）作为参数传递给数据库，而不是直接拼接成SQL语句的方法。这意味着用户输入的数据不再与SQL代码直接混合，从而避免了攻击者通过注入恶意代码来操控数据库的机会。"}]},{"ID":"20241016092241-b6dlz88","Type":"NodeParagraph","Properties":{"id":"20241016092241-b6dlz88","updated":"20241016092241"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"预编译语句"},{"Type":"NodeText","Data":"是指SQL查询在数据库执行之前先进行编译，固定SQL查询的结构，然后在执行时仅仅替换查询中的参数值。这种方法不仅提高了性能，还增强了安全性。"}]},{"ID":"20241016092242-xom19kc","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092242-xom19kc","updated":"20241016092242"},"Children":[{"Type":"NodeText","Data":"2. 参数化查询/预编译语句的工作原理"}]},{"ID":"20241016092243-7rmdbw9","Type":"NodeParagraph","Properties":{"id":"20241016092243-7rmdbw9","updated":"20241016092243"},"Children":[{"Type":"NodeText","Data":"在不使用参数化查询的情况下，应用程序可能会拼接用户输入到SQL查询中。例如："}]},{"ID":"20241016092244-nlciez7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cHl0aG9u","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092244-nlciez7","updated":"20241016092244"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"# 不安全的拼接查询\nusername = \"user_input\"\nquery = \"SELECT * FROM users WHERE username = '\" + username + \"'\"\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092245-1j6riwu","Type":"NodeParagraph","Properties":{"id":"20241016092245-1j6riwu","updated":"20241016092245"},"Children":[{"Type":"NodeText","Data":"如果攻击者输入了恶意代码，例如"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' OR '1'='1"},{"Type":"NodeText","Data":"，那么最终的查询将变成："}]},{"ID":"20241016092246-3qrazvv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092246-3qrazvv","updated":"20241016092246"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = '' OR '1'='1';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092247-se7hhgt","Type":"NodeParagraph","Properties":{"id":"20241016092247-se7hhgt","updated":"20241016092247"},"Children":[{"Type":"NodeText","Data":"这会导致SQL注入风险。"}]},{"ID":"20241016092248-y9jo7y0","Type":"NodeParagraph","Properties":{"id":"20241016092248-y9jo7y0","updated":"20241016092248"},"Children":[{"Type":"NodeText","Data":"而使用参数化查询时，SQL语句和用户输入分离，查询结构不会被用户输入所改变。例如，在Python中使用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"MySQL"},{"Type":"NodeText","Data":"的库进行参数化查询："}]},{"ID":"20241016092249-xbgh704","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cHl0aG9u","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092249-xbgh704","updated":"20241016092249"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"# 安全的参数化查询\ncursor.execute(\"SELECT * FROM users WHERE username = %s\", (username,))\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092250-97h7h93","Type":"NodeParagraph","Properties":{"id":"20241016092250-97h7h93","updated":"20241016092250"},"Children":[{"Type":"NodeText","Data":"即使攻击者输入了"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' OR '1'='1"},{"Type":"NodeText","Data":"，数据库会将其视为纯文本，不会解释为SQL命令。实际上，查询会变成："}]},{"ID":"20241016092251-677w8e0","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092251-677w8e0","updated":"20241016092251"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM users WHERE username = \"' OR '1'='1\";\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20241016092252-bsiuwcv","Type":"NodeParagraph","Properties":{"id":"20241016092252-bsiuwcv","updated":"20241016092252"},"Children":[{"Type":"NodeText","Data":"因为攻击者的输入被当作参数，而不是SQL代码的一部分，数据库不会执行其中的恶意逻辑，SQL注入攻击就被防止了。"}]},{"ID":"20241016092253-q48cdye","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092253-q48cdye","updated":"20241016092255"},"Children":[{"Type":"NodeText","Data":"3. 为什么即便输入恶意代码，数据库也不会将其解释为SQL命令？"}]},{"ID":"20241016092254-uan2xg2","Type":"NodeParagraph","Properties":{"id":"20241016092254-uan2xg2","updated":"20241016092254"},"Children":[{"Type":"NodeText","Data":"这是因为在参数化查询中，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"用户输入与SQL查询的结构是分离的"},{"Type":"NodeText","Data":"。SQL语句本身是预先定义好的，而用户输入被当作“数据”，由数据库专门处理，作为字符串或数值来处理，而不是作为SQL的一部分进行解析。"}]},{"ID":"20241016092255-xomd8vx","Type":"NodeParagraph","Properties":{"id":"20241016092255-xomd8vx","updated":"20241016092255"},"Children":[{"Type":"NodeText","Data":"具体的安全机制："}]},{"ID":"20241016092256-p7f8zli","Type":"NodeList","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092256-p7f8zli","updated":"20241016092256"},"Children":[{"ID":"20241016092257-fdhcdc1","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20241016092257-fdhcdc1","updated":"20241016092257"},"Children":[{"ID":"20241016092258-4rawd4m","Type":"NodeParagraph","Properties":{"id":"20241016092258-4rawd4m","updated":"20241016092258"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"SQL查询的结构已固定"},{"Type":"NodeText","Data":"：预编译语句会先将SQL查询的结构（如表名、列名、查询条件等）发送给数据库进行编译，而用户输入被当作参数单独处理。SQL的执行顺序与逻辑已提前确定，因此攻击者无法通过操纵输入来改变SQL的执行逻辑。"}]}]},{"ID":"20241016092259-vfljoe2","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20241016092259-vfljoe2","updated":"20241016092259"},"Children":[{"ID":"20241016092260-8gm8rt0","Type":"NodeParagraph","Properties":{"id":"20241016092260-8gm8rt0","updated":"20241016092260"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"用户输入作为参数被转义"},{"Type":"NodeText","Data":"：当用户输入被当作参数时，数据库会自动转义特殊字符，使得它们不会被解析为SQL命令。例如，单引号、双引号等特殊字符在参数化查询中会被转义成普通文本。即使用户输入了"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' OR '1'='1"},{"Type":"NodeText","Data":"，数据库也会将其处理为普通的字符串。"}]}]},{"ID":"20241016092261-cu3vlmi","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20241016092261-cu3vlmi","updated":"20241016092261"},"Children":[{"ID":"20241016092262-dmf1tgv","Type":"NodeParagraph","Properties":{"id":"20241016092262-dmf1tgv","updated":"20241016092262"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"不同的数据类型严格区分"},{"Type":"NodeText","Data":"：在参数化查询中，数据库会严格区分数据类型。如果查询期望的是数值类型的参数，而用户输入了SQL代码片段，数据库会自动识别类型不匹配，防止代码注入。"}]}]}]},{"ID":"20241016092263-ztu9gss","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092263-ztu9gss","updated":"20241016092263"},"Children":[{"Type":"NodeText","Data":"4. 参数化查询的优点"}]},{"ID":"20241016092264-ojzpjqw","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092264-ojzpjqw","updated":"20241016092264"},"Children":[{"ID":"20241016092265-e7rqrsu","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092265-e7rqrsu","updated":"20241016092265"},"Children":[{"ID":"20241016092266-yl0e4h3","Type":"NodeParagraph","Properties":{"id":"20241016092266-yl0e4h3","updated":"20241016092266"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"安全性"},{"Type":"NodeText","Data":"：通过分离查询逻辑和用户输入，SQL注入攻击几乎是不可能的。即便用户输入恶意代码，数据库也只会将其当作普通数据处理，不会影响查询结构。"}]}]},{"ID":"20241016092267-bikwl74","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092267-bikwl74","updated":"20241016092267"},"Children":[{"ID":"20241016092268-jizl1y9","Type":"NodeParagraph","Properties":{"id":"20241016092268-jizl1y9","updated":"20241016092268"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"性能提升"},{"Type":"NodeText","Data":"：因为SQL语句的结构是预先编译的，数据库可以重用相同的查询模板，减少了每次查询时的解析和编译时间，尤其在高并发的场景下显得更为高效。"}]}]},{"ID":"20241016092269-fcfakjm","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092269-fcfakjm","updated":"20241016092269"},"Children":[{"ID":"20241016092270-52634r9","Type":"NodeParagraph","Properties":{"id":"20241016092270-52634r9","updated":"20241016092270"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"代码可读性"},{"Type":"NodeText","Data":"：参数化查询避免了将大量的输入拼接到SQL字符串中，代码更简洁易懂，也减少了人为拼接SQL时出现语法错误的风险。"}]}]}]},{"ID":"20241016092271-pdubsc0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092271-pdubsc0","updated":"20241016092271"},"Children":[{"Type":"NodeText","Data":"5. 示例：参数化查询在不同编程语言中的使用"}]},{"ID":"20241016092272-9grmg4u","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092272-9grmg4u","updated":"20241016092272"},"Children":[{"ID":"20241016092273-7s9vw5g","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092273-7s9vw5g","updated":"20241016092273"},"Children":[{"ID":"20241016092274-asrco79","Type":"NodeParagraph","Properties":{"id":"20241016092274-asrco79","updated":"20241016092274"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"Python"},{"Type":"NodeText","Data":"（使用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"MySQL"},{"Type":"NodeText","Data":"或"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SQLite"},{"Type":"NodeText","Data":"）："}]},{"ID":"20241016092275-xfp39bb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cHl0aG9u","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092275-xfp39bb","updated":"20241016092275"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"# 使用参数化查询的Python代码\ncursor.execute(\"SELECT * FROM users WHERE username = %s\", (username,))\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20241016092276-i47kctd","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092276-i47kctd","updated":"20241016092276"},"Children":[{"ID":"20241016092277-uh4lkuw","Type":"NodeParagraph","Properties":{"id":"20241016092277-uh4lkuw","updated":"20241016092277"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"Java"},{"Type":"NodeText","Data":"（使用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"PreparedStatement"},{"Type":"NodeText","Data":"）："}]},{"ID":"20241016092278-j57owf9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092278-j57owf9","updated":"20241016092278"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"String query = \"SELECT * FROM users WHERE username = ?\";\nPreparedStatement pstmt = connection.prepareStatement(query);\npstmt.setString(1, username);\nResultSet rs = pstmt.executeQuery();\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20241016092279-oqnc6tb","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092279-oqnc6tb","updated":"20241016092279"},"Children":[{"ID":"20241016092280-cgyv4vy","Type":"NodeParagraph","Properties":{"id":"20241016092280-cgyv4vy","updated":"20241016092280"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"PHP"},{"Type":"NodeText","Data":"（使用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"PDO"},{"Type":"NodeText","Data":"）："}]},{"ID":"20241016092281-0hifgrs","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cGhw","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092281-0hifgrs","updated":"20241016092281"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"$stmt = $pdo-\u003eprepare(\"SELECT * FROM users WHERE username = ?\");\n$stmt-\u003eexecute([$username]);\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20241016092282-m54l9il","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092282-m54l9il","updated":"20241016092282"},"Children":[{"ID":"20241016092283-huxdnm4","Type":"NodeParagraph","Properties":{"id":"20241016092283-huxdnm4","updated":"20241016092283"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"C#"},{"Type":"NodeText","Data":"（使用"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SqlCommand"},{"Type":"NodeText","Data":"）："}]},{"ID":"20241016092284-5g86e5n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"Y3NoYXJw","CodeBlockCloseFence":"YGBg","Properties":{"id":"20241016092284-5g86e5n","updated":"20241016092284"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SqlCommand command = new SqlCommand(\"SELECT * FROM users WHERE username = @username\", connection);\ncommand.Parameters.AddWithValue(\"@username\", username);\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]}]},{"ID":"20241016092285-meg54c8","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092285-meg54c8","updated":"20241016092285"},"Children":[{"Type":"NodeText","Data":"6. 预编译语句的局限性"}]},{"ID":"20241016092286-h1d2t55","Type":"NodeParagraph","Properties":{"id":"20241016092286-h1d2t55","updated":"20241016092286"},"Children":[{"Type":"NodeText","Data":"虽然参数化查询极大地提高了安全性，但也有以下几点需要注意："}]},{"ID":"20241016092287-tx6xaxv","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092287-tx6xaxv","updated":"20241016092287"},"Children":[{"ID":"20241016092288-4chjmzi","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092288-4chjmzi","updated":"20241016092288"},"Children":[{"ID":"20241016092289-7i5ijhh","Type":"NodeParagraph","Properties":{"id":"20241016092289-7i5ijhh","updated":"20241016092289"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"复杂查询的限制"},{"Type":"NodeText","Data":"：在某些非常复杂的查询中，尤其是动态生成SQL查询的场景下，参数化查询的使用可能不够灵活。这种情况下，开发者仍需谨慎处理动态SQL，确保没有注入漏洞。"}]}]},{"ID":"20241016092290-dbhfmp7","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20241016092290-dbhfmp7","updated":"20241016092290"},"Children":[{"ID":"20241016092291-b2do3na","Type":"NodeParagraph","Properties":{"id":"20241016092291-b2do3na","updated":"20241016092291"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"并非防止所有攻击"},{"Type":"NodeText","Data":"：虽然参数化查询可以防止SQL注入，但它不能防止其他类型的攻击，如跨站脚本（XSS）攻击或拒绝服务（DoS）攻击。开发者仍需全面考虑系统的安全防护。"}]}]}]},{"ID":"20241016092292-qk021of","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016092292-qk021of","updated":"20241016092292"},"Children":[{"Type":"NodeText","Data":"总结"}]},{"ID":"20241016092293-ny6hexn","Type":"NodeParagraph","Properties":{"id":"20241016092293-ny6hexn","updated":"20241016092293"},"Children":[{"Type":"NodeText","Data":"参数化查询/预编译语句通过将用户输入与SQL查询分离，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a strong","TextMarkTextContent":"并将用户输入视为纯数据而不是代码"},{"Type":"NodeText","Data":"，从根本上防止了SQL注入攻击。即使攻击者输入恶意的SQL代码，数据库也只会将其作为普通文本处理，确保应用程序的安全。采用这种方法可以有效地降低系统的风险，并提高查询的性能和代码的可维护性。"}]}]}]},{"ID":"20241016092294-yg5si1j","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092294-yg5si1j","updated":"20241016092294"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"使用ORM"}]},{"ID":"20241016092295-jsxenwh","Type":"NodeParagraph","Properties":{"id":"20241016092295-jsxenwh","updated":"20241016092295"},"Children":[{"Type":"NodeText","Data":"减少手动编写SQL"}]},{"ID":"20241016092296-xvteqct","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092296-xvteqct","updated":"20241016092296"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"输入校验与过滤"}]},{"ID":"20241016092297-1w0vc4l","Type":"NodeParagraph","Properties":{"id":"20241016092297-1w0vc4l","updated":"20241016092297"},"Children":[{"Type":"NodeText","Data":"例如直接不允许输入英文符号"}]},{"ID":"20241016092298-tvfnetj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241016092298-tvfnetj","updated":"20241016160520"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"最小权限"}]},{"ID":"20241016092299-m0josnl","Type":"NodeParagraph","Properties":{"id":"20241016092299-m0josnl","updated":"20241016092299"},"Children":[{"Type":"NodeText","Data":"将数据库用户的权限控制在最小，比如不能让用户删库"}]},{"ID":"20241016160520-rfqmgid","Type":"NodeParagraph","Properties":{"id":"20241016160520-rfqmgid","updated":"20241016160520"}}]}